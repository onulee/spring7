<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.java.dao.BoardMapper">
   
   <!-- 게시글 전체가져오기 -->
   <select id="selectAll" resultType="com.java.dto.BoardDto">
   		select * from board order by bgroup desc,bstep asc 
   </select>
   <!-- 게시글 1개가져오기 -->
   <select id="selectOne" resultType="com.java.dto.BoardDto">
   		select * from board where bno=#{bno}
   </select>
   <!-- 게시글 수정 -->
   <update id="updateBoard">
        update board set btitle=#{btitle},bcontent=#{bcontent},
        bfile=#{bfile},bdate=sysdate
        where bno=#{bno}
   </update>
   
   <!-- 게시글 저장 -->
   <insert id="insertBoard">
   		insert into board values (
		 board_seq.nextval,#{btitle},#{bcontent},
		 #{id},board_seq.currval,0,0,0,'',sysdate
		)
   </insert>
   
   <!-- 답변달기 bstep증가부분 -->
   <!--  -->
   <update id="updateReply">
   		<![CDATA[
	   		update board set bstep = bstep+1 
	   		where bgroup=#{bgroup} and bstep>#{bstep}
   		]]>
   </update>
   <!-- 답변달기 저장 -->
   <insert id="insertReply">
   		insert into board values (
		 board_seq.nextval,#{btitle},#{bcontent},
		 #{id},#{bgroup},#{bstep}+1,#{bindent}+1,0,'',sysdate
		)
   </insert>
   
   <!-- 게시글 삭제 -->
   <delete id="deleteBoard">
       delete board where bno = #{bno}
   </delete>
   
   
</mapper>